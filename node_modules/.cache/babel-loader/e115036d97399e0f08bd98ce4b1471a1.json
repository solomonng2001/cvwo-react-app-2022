{"ast":null,"code":"import _slicedToArray from \"/Users/solomonng/dev/cvwo-rails-react-app/cvwo-react-app-2022/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { unstable_useForkRef as useForkRef, unstable_useId as useId } from '@mui/utils';\nimport { ActionTypes } from './useListbox.types';\nimport defaultReducer from './defaultListboxReducer';\nimport useControllableReducer from './useControllableReducer';\nimport areArraysEqual from '../utils/areArraysEqual';\nvar TEXT_NAVIGATION_RESET_TIMEOUT = 500; // milliseconds\n\nvar defaultOptionComparer = function defaultOptionComparer(optionA, optionB) {\n  return optionA === optionB;\n};\n\nvar defaultIsOptionDisabled = function defaultIsOptionDisabled() {\n  return false;\n};\n\nvar defaultOptionStringifier = function defaultOptionStringifier(option) {\n  return typeof option === 'string' ? option : String(option);\n};\n\nexport default function useListbox(props) {\n  var _props$optionIdGenera, _options$highlightedI;\n\n  var _props$disabledItemsF = props.disabledItemsFocusable,\n      disabledItemsFocusable = _props$disabledItemsF === void 0 ? false : _props$disabledItemsF,\n      _props$disableListWra = props.disableListWrap,\n      disableListWrap = _props$disableListWra === void 0 ? false : _props$disableListWra,\n      _props$focusManagemen = props.focusManagement,\n      focusManagement = _props$focusManagemen === void 0 ? 'activeDescendant' : _props$focusManagemen,\n      idProp = props.id,\n      _props$isOptionDisabl = props.isOptionDisabled,\n      isOptionDisabled = _props$isOptionDisabl === void 0 ? defaultIsOptionDisabled : _props$isOptionDisabl,\n      externalListboxRef = props.listboxRef,\n      _props$multiple = props.multiple,\n      multiple = _props$multiple === void 0 ? false : _props$multiple,\n      _props$optionComparer = props.optionComparer,\n      optionComparer = _props$optionComparer === void 0 ? defaultOptionComparer : _props$optionComparer,\n      _props$optionStringif = props.optionStringifier,\n      optionStringifier = _props$optionStringif === void 0 ? defaultOptionStringifier : _props$optionStringif,\n      options = props.options,\n      externalReducer = props.stateReducer;\n  var id = useId(idProp);\n\n  function defaultIdGenerator(_, index) {\n    return \"\".concat(id, \"-option-\").concat(index);\n  }\n\n  var optionIdGenerator = (_props$optionIdGenera = props.optionIdGenerator) != null ? _props$optionIdGenera : defaultIdGenerator;\n\n  var propsWithDefaults = _extends({}, props, {\n    disabledItemsFocusable: disabledItemsFocusable,\n    disableListWrap: disableListWrap,\n    focusManagement: focusManagement,\n    isOptionDisabled: isOptionDisabled,\n    multiple: multiple,\n    optionComparer: optionComparer,\n    optionStringifier: optionStringifier\n  });\n\n  var listboxRef = React.useRef(null);\n  var handleRef = useForkRef(externalListboxRef, listboxRef);\n  var textCriteriaRef = React.useRef({\n    searchString: '',\n    lastTime: null\n  });\n\n  var _useControllableReduc = useControllableReducer(defaultReducer, externalReducer, propsWithDefaults),\n      _useControllableReduc2 = _slicedToArray(_useControllableReduc, 2),\n      _useControllableReduc3 = _useControllableReduc2[0],\n      highlightedValue = _useControllableReduc3.highlightedValue,\n      selectedValue = _useControllableReduc3.selectedValue,\n      dispatch = _useControllableReduc2[1];\n\n  var highlightedIndex = React.useMemo(function () {\n    return highlightedValue == null ? -1 : options.findIndex(function (option) {\n      return optionComparer(option, highlightedValue);\n    });\n  }, [highlightedValue, options, optionComparer]);\n  var previousOptions = React.useRef([]);\n  React.useEffect(function () {\n    if (areArraysEqual(previousOptions.current, options, optionComparer)) {\n      return;\n    }\n\n    dispatch({\n      type: ActionTypes.optionsChange,\n      event: null,\n      options: options,\n      previousOptions: previousOptions.current,\n      props: propsWithDefaults\n    });\n    previousOptions.current = options; // No need to re-run this effect if props change\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options, optionComparer, dispatch]);\n  var setSelectedValue = React.useCallback(function (option) {\n    dispatch({\n      type: ActionTypes.setValue,\n      event: null,\n      value: option\n    });\n  }, [dispatch]);\n  var setHighlightedValue = React.useCallback(function (option) {\n    dispatch({\n      type: ActionTypes.setHighlight,\n      event: null,\n      highlight: option\n    });\n  }, [dispatch]);\n\n  var createHandleOptionClick = function createHandleOptionClick(option, other) {\n    return function (event) {\n      var _other$onClick;\n\n      (_other$onClick = other.onClick) == null ? void 0 : _other$onClick.call(other, event);\n\n      if (event.defaultPrevented) {\n        return;\n      }\n\n      event.preventDefault();\n      dispatch({\n        type: ActionTypes.optionClick,\n        option: option,\n        event: event,\n        props: propsWithDefaults\n      });\n    };\n  };\n\n  var createHandleOptionPointerOver = function createHandleOptionPointerOver(option, other) {\n    return function (event) {\n      var _other$onMouseOver;\n\n      (_other$onMouseOver = other.onMouseOver) == null ? void 0 : _other$onMouseOver.call(other, event);\n\n      if (event.defaultPrevented) {\n        return;\n      }\n\n      dispatch({\n        type: ActionTypes.optionHover,\n        option: option,\n        event: event,\n        props: propsWithDefaults\n      });\n    };\n  };\n\n  var createHandleKeyDown = function createHandleKeyDown(other) {\n    return function (event) {\n      var _other$onKeyDown;\n\n      (_other$onKeyDown = other.onKeyDown) == null ? void 0 : _other$onKeyDown.call(other, event);\n\n      if (event.defaultPrevented) {\n        return;\n      }\n\n      var keysToPreventDefault = ['ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'];\n\n      if (focusManagement === 'activeDescendant') {\n        // When the child element is focused using the activeDescendant attribute,\n        // the listbox handles keyboard events on its behalf.\n        // We have to `preventDefault()` is this case to prevent the browser from\n        // scrolling the view when space is pressed or submitting forms when enter is pressed.\n        keysToPreventDefault.push(' ', 'Enter');\n      }\n\n      if (keysToPreventDefault.includes(event.key)) {\n        event.preventDefault();\n      }\n\n      dispatch({\n        type: ActionTypes.keyDown,\n        event: event,\n        props: propsWithDefaults\n      }); // Handle text navigation\n\n      if (event.key.length === 1 && event.key !== ' ') {\n        var textCriteria = textCriteriaRef.current;\n        var lowerKey = event.key.toLowerCase();\n        var currentTime = performance.now();\n\n        if (textCriteria.searchString.length > 0 && textCriteria.lastTime && currentTime - textCriteria.lastTime > TEXT_NAVIGATION_RESET_TIMEOUT) {\n          textCriteria.searchString = lowerKey;\n        } else if (textCriteria.searchString.length !== 1 || lowerKey !== textCriteria.searchString) {\n          // If there is just one character in the buffer and the key is the same, do not append\n          textCriteria.searchString += lowerKey;\n        }\n\n        textCriteria.lastTime = currentTime;\n        dispatch({\n          type: ActionTypes.textNavigation,\n          event: event,\n          searchString: textCriteria.searchString,\n          props: propsWithDefaults\n        });\n      }\n    };\n  };\n\n  var createHandleBlur = function createHandleBlur(other) {\n    return function (event) {\n      var _other$onBlur, _listboxRef$current;\n\n      (_other$onBlur = other.onBlur) == null ? void 0 : _other$onBlur.call(other, event);\n\n      if (event.defaultPrevented) {\n        return;\n      }\n\n      if ((_listboxRef$current = listboxRef.current) != null && _listboxRef$current.contains(document.activeElement)) {\n        // focus is within the listbox\n        return;\n      }\n\n      dispatch({\n        type: ActionTypes.blur,\n        event: event,\n        props: propsWithDefaults\n      });\n    };\n  };\n\n  var getRootProps = function getRootProps() {\n    var otherHandlers = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return _extends({}, otherHandlers, {\n      'aria-activedescendant': focusManagement === 'activeDescendant' && highlightedValue != null ? optionIdGenerator(highlightedValue, highlightedIndex) : undefined,\n      id: id,\n      onBlur: createHandleBlur(otherHandlers),\n      onKeyDown: createHandleKeyDown(otherHandlers),\n      role: 'listbox',\n      tabIndex: focusManagement === 'DOM' ? -1 : 0,\n      ref: handleRef\n    });\n  };\n\n  var getOptionState = function getOptionState(option) {\n    var selected;\n    var index = options.findIndex(function (opt) {\n      return optionComparer(opt, option);\n    });\n\n    if (multiple) {\n      var _ref;\n\n      selected = ((_ref = selectedValue) != null ? _ref : []).some(function (value) {\n        return value != null && optionComparer(option, value);\n      });\n    } else {\n      selected = optionComparer(option, selectedValue);\n    }\n\n    var disabled = isOptionDisabled(option, index);\n    return {\n      selected: selected,\n      disabled: disabled,\n      highlighted: highlightedIndex === index\n    };\n  };\n\n  var getOptionTabIndex = function getOptionTabIndex(optionState) {\n    if (focusManagement === 'activeDescendant') {\n      return undefined;\n    }\n\n    if (!optionState.highlighted) {\n      return -1;\n    }\n\n    if (optionState.disabled && !disabledItemsFocusable) {\n      return -1;\n    }\n\n    return 0;\n  };\n\n  var getOptionProps = function getOptionProps(option) {\n    var otherHandlers = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var optionState = getOptionState(option);\n    var index = options.findIndex(function (opt) {\n      return optionComparer(opt, option);\n    });\n    return _extends({}, otherHandlers, {\n      'aria-disabled': optionState.disabled || undefined,\n      'aria-selected': optionState.selected,\n      id: optionIdGenerator(option, index),\n      onClick: createHandleOptionClick(option, otherHandlers),\n      onPointerOver: createHandleOptionPointerOver(option, otherHandlers),\n      role: 'option',\n      tabIndex: getOptionTabIndex(optionState)\n    });\n  };\n\n  React.useDebugValue({\n    highlightedOption: options[highlightedIndex],\n    selectedOption: selectedValue\n  });\n  return {\n    getRootProps: getRootProps,\n    getOptionProps: getOptionProps,\n    getOptionState: getOptionState,\n    highlightedOption: (_options$highlightedI = options[highlightedIndex]) != null ? _options$highlightedI : null,\n    selectedOption: selectedValue,\n    setSelectedValue: setSelectedValue,\n    setHighlightedValue: setHighlightedValue\n  };\n}","map":{"version":3,"sources":["/Users/solomonng/dev/cvwo-rails-react-app/cvwo-react-app-2022/node_modules/@mui/base/ListboxUnstyled/useListbox.js"],"names":["_extends","React","unstable_useForkRef","useForkRef","unstable_useId","useId","ActionTypes","defaultReducer","useControllableReducer","areArraysEqual","TEXT_NAVIGATION_RESET_TIMEOUT","defaultOptionComparer","optionA","optionB","defaultIsOptionDisabled","defaultOptionStringifier","option","String","useListbox","props","_props$optionIdGenera","_options$highlightedI","disabledItemsFocusable","disableListWrap","focusManagement","idProp","id","isOptionDisabled","externalListboxRef","listboxRef","multiple","optionComparer","optionStringifier","options","externalReducer","stateReducer","defaultIdGenerator","_","index","optionIdGenerator","propsWithDefaults","useRef","handleRef","textCriteriaRef","searchString","lastTime","highlightedValue","selectedValue","dispatch","highlightedIndex","useMemo","findIndex","previousOptions","useEffect","current","type","optionsChange","event","setSelectedValue","useCallback","setValue","value","setHighlightedValue","setHighlight","highlight","createHandleOptionClick","other","_other$onClick","onClick","call","defaultPrevented","preventDefault","optionClick","createHandleOptionPointerOver","_other$onMouseOver","onMouseOver","optionHover","createHandleKeyDown","_other$onKeyDown","onKeyDown","keysToPreventDefault","push","includes","key","keyDown","length","textCriteria","lowerKey","toLowerCase","currentTime","performance","now","textNavigation","createHandleBlur","_other$onBlur","_listboxRef$current","onBlur","contains","document","activeElement","blur","getRootProps","otherHandlers","undefined","role","tabIndex","ref","getOptionState","selected","opt","_ref","some","disabled","highlighted","getOptionTabIndex","optionState","getOptionProps","onPointerOver","useDebugValue","highlightedOption","selectedOption"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport { unstable_useForkRef as useForkRef, unstable_useId as useId } from '@mui/utils';\nimport { ActionTypes } from './useListbox.types';\nimport defaultReducer from './defaultListboxReducer';\nimport useControllableReducer from './useControllableReducer';\nimport areArraysEqual from '../utils/areArraysEqual';\nconst TEXT_NAVIGATION_RESET_TIMEOUT = 500; // milliseconds\n\nconst defaultOptionComparer = (optionA, optionB) => optionA === optionB;\nconst defaultIsOptionDisabled = () => false;\nconst defaultOptionStringifier = option => typeof option === 'string' ? option : String(option);\nexport default function useListbox(props) {\n  var _props$optionIdGenera, _options$highlightedI;\n  const {\n    disabledItemsFocusable = false,\n    disableListWrap = false,\n    focusManagement = 'activeDescendant',\n    id: idProp,\n    isOptionDisabled = defaultIsOptionDisabled,\n    listboxRef: externalListboxRef,\n    multiple = false,\n    optionComparer = defaultOptionComparer,\n    optionStringifier = defaultOptionStringifier,\n    options,\n    stateReducer: externalReducer\n  } = props;\n  const id = useId(idProp);\n  function defaultIdGenerator(_, index) {\n    return `${id}-option-${index}`;\n  }\n  const optionIdGenerator = (_props$optionIdGenera = props.optionIdGenerator) != null ? _props$optionIdGenera : defaultIdGenerator;\n  const propsWithDefaults = _extends({}, props, {\n    disabledItemsFocusable,\n    disableListWrap,\n    focusManagement,\n    isOptionDisabled,\n    multiple,\n    optionComparer,\n    optionStringifier\n  });\n  const listboxRef = React.useRef(null);\n  const handleRef = useForkRef(externalListboxRef, listboxRef);\n  const textCriteriaRef = React.useRef({\n    searchString: '',\n    lastTime: null\n  });\n  const [{\n    highlightedValue,\n    selectedValue\n  }, dispatch] = useControllableReducer(defaultReducer, externalReducer, propsWithDefaults);\n  const highlightedIndex = React.useMemo(() => {\n    return highlightedValue == null ? -1 : options.findIndex(option => optionComparer(option, highlightedValue));\n  }, [highlightedValue, options, optionComparer]);\n  const previousOptions = React.useRef([]);\n  React.useEffect(() => {\n    if (areArraysEqual(previousOptions.current, options, optionComparer)) {\n      return;\n    }\n    dispatch({\n      type: ActionTypes.optionsChange,\n      event: null,\n      options,\n      previousOptions: previousOptions.current,\n      props: propsWithDefaults\n    });\n    previousOptions.current = options;\n\n    // No need to re-run this effect if props change\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options, optionComparer, dispatch]);\n  const setSelectedValue = React.useCallback(option => {\n    dispatch({\n      type: ActionTypes.setValue,\n      event: null,\n      value: option\n    });\n  }, [dispatch]);\n  const setHighlightedValue = React.useCallback(option => {\n    dispatch({\n      type: ActionTypes.setHighlight,\n      event: null,\n      highlight: option\n    });\n  }, [dispatch]);\n  const createHandleOptionClick = (option, other) => event => {\n    var _other$onClick;\n    (_other$onClick = other.onClick) == null ? void 0 : _other$onClick.call(other, event);\n    if (event.defaultPrevented) {\n      return;\n    }\n    event.preventDefault();\n    dispatch({\n      type: ActionTypes.optionClick,\n      option,\n      event,\n      props: propsWithDefaults\n    });\n  };\n  const createHandleOptionPointerOver = (option, other) => event => {\n    var _other$onMouseOver;\n    (_other$onMouseOver = other.onMouseOver) == null ? void 0 : _other$onMouseOver.call(other, event);\n    if (event.defaultPrevented) {\n      return;\n    }\n    dispatch({\n      type: ActionTypes.optionHover,\n      option,\n      event,\n      props: propsWithDefaults\n    });\n  };\n  const createHandleKeyDown = other => event => {\n    var _other$onKeyDown;\n    (_other$onKeyDown = other.onKeyDown) == null ? void 0 : _other$onKeyDown.call(other, event);\n    if (event.defaultPrevented) {\n      return;\n    }\n    const keysToPreventDefault = ['ArrowUp', 'ArrowDown', 'Home', 'End', 'PageUp', 'PageDown'];\n    if (focusManagement === 'activeDescendant') {\n      // When the child element is focused using the activeDescendant attribute,\n      // the listbox handles keyboard events on its behalf.\n      // We have to `preventDefault()` is this case to prevent the browser from\n      // scrolling the view when space is pressed or submitting forms when enter is pressed.\n      keysToPreventDefault.push(' ', 'Enter');\n    }\n    if (keysToPreventDefault.includes(event.key)) {\n      event.preventDefault();\n    }\n    dispatch({\n      type: ActionTypes.keyDown,\n      event,\n      props: propsWithDefaults\n    });\n\n    // Handle text navigation\n    if (event.key.length === 1 && event.key !== ' ') {\n      const textCriteria = textCriteriaRef.current;\n      const lowerKey = event.key.toLowerCase();\n      const currentTime = performance.now();\n      if (textCriteria.searchString.length > 0 && textCriteria.lastTime && currentTime - textCriteria.lastTime > TEXT_NAVIGATION_RESET_TIMEOUT) {\n        textCriteria.searchString = lowerKey;\n      } else if (textCriteria.searchString.length !== 1 || lowerKey !== textCriteria.searchString) {\n        // If there is just one character in the buffer and the key is the same, do not append\n        textCriteria.searchString += lowerKey;\n      }\n      textCriteria.lastTime = currentTime;\n      dispatch({\n        type: ActionTypes.textNavigation,\n        event,\n        searchString: textCriteria.searchString,\n        props: propsWithDefaults\n      });\n    }\n  };\n  const createHandleBlur = other => event => {\n    var _other$onBlur, _listboxRef$current;\n    (_other$onBlur = other.onBlur) == null ? void 0 : _other$onBlur.call(other, event);\n    if (event.defaultPrevented) {\n      return;\n    }\n    if ((_listboxRef$current = listboxRef.current) != null && _listboxRef$current.contains(document.activeElement)) {\n      // focus is within the listbox\n      return;\n    }\n    dispatch({\n      type: ActionTypes.blur,\n      event,\n      props: propsWithDefaults\n    });\n  };\n  const getRootProps = (otherHandlers = {}) => {\n    return _extends({}, otherHandlers, {\n      'aria-activedescendant': focusManagement === 'activeDescendant' && highlightedValue != null ? optionIdGenerator(highlightedValue, highlightedIndex) : undefined,\n      id,\n      onBlur: createHandleBlur(otherHandlers),\n      onKeyDown: createHandleKeyDown(otherHandlers),\n      role: 'listbox',\n      tabIndex: focusManagement === 'DOM' ? -1 : 0,\n      ref: handleRef\n    });\n  };\n  const getOptionState = option => {\n    let selected;\n    const index = options.findIndex(opt => optionComparer(opt, option));\n    if (multiple) {\n      var _ref;\n      selected = ((_ref = selectedValue) != null ? _ref : []).some(value => value != null && optionComparer(option, value));\n    } else {\n      selected = optionComparer(option, selectedValue);\n    }\n    const disabled = isOptionDisabled(option, index);\n    return {\n      selected,\n      disabled,\n      highlighted: highlightedIndex === index\n    };\n  };\n  const getOptionTabIndex = optionState => {\n    if (focusManagement === 'activeDescendant') {\n      return undefined;\n    }\n    if (!optionState.highlighted) {\n      return -1;\n    }\n    if (optionState.disabled && !disabledItemsFocusable) {\n      return -1;\n    }\n    return 0;\n  };\n  const getOptionProps = (option, otherHandlers = {}) => {\n    const optionState = getOptionState(option);\n    const index = options.findIndex(opt => optionComparer(opt, option));\n    return _extends({}, otherHandlers, {\n      'aria-disabled': optionState.disabled || undefined,\n      'aria-selected': optionState.selected,\n      id: optionIdGenerator(option, index),\n      onClick: createHandleOptionClick(option, otherHandlers),\n      onPointerOver: createHandleOptionPointerOver(option, otherHandlers),\n      role: 'option',\n      tabIndex: getOptionTabIndex(optionState)\n    });\n  };\n  React.useDebugValue({\n    highlightedOption: options[highlightedIndex],\n    selectedOption: selectedValue\n  });\n  return {\n    getRootProps,\n    getOptionProps,\n    getOptionState,\n    highlightedOption: (_options$highlightedI = options[highlightedIndex]) != null ? _options$highlightedI : null,\n    selectedOption: selectedValue,\n    setSelectedValue,\n    setHighlightedValue\n  };\n}"]},"metadata":{},"sourceType":"module"}