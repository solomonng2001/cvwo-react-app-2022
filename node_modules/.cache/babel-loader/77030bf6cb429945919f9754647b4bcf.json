{"ast":null,"code":"import _slicedToArray from\"/Users/solomonng/dev/cvwo-rails-react-app/cvwo-react-app-2022/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button,TextField,Dialog,DialogActions,DialogContent,DialogTitle,DialogContentText}from'@material-ui/core';import AlertUser from'./AlertUser';import React,{useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LogIn=function LogIn(_ref){var API=_ref.API,openLogIn=_ref.openLogIn,handleCloseLogIn=_ref.handleCloseLogIn,currentUserState=_ref.currentUserState,globalMessageState=_ref.globalMessageState;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState('success'),_useState6=_slicedToArray(_useState5,2),severity=_useState6[0],setSeverity=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),message=_useState8[0],setMessage=_useState8[1];var resetLogIn=function resetLogIn(){setUsername(\"\");setPassword(\"\");};var handleSubmitLogIn=function handleSubmitLogIn(){var new_message=[];fetch(API+\"/login\",{method:'POST',headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username:username,password:password})}).then(function(response){return response.json();}).then(function(data){if(data.error){setSeverity('error');data.error.map(function(error){return new_message.push(error);});setMessage(new_message);}else{currentUserState.setCurrentUser(data.user);localStorage.setItem(\"token\",data.token);setSeverity('success');new_message.push(\"Logged in successfully!\");setMessage(new_message);resetLogIn();setTimeout(function(){return window.location.reload();},1000);}}).catch(function(error){return console.log(error.message);});};return/*#__PURE__*/_jsxs(Dialog,{open:openLogIn,onClose:handleCloseLogIn,fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Welcome Back!\"}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(DialogContentText,{children:\"Log in to create threads, comment and more...\"}),/*#__PURE__*/_jsx(DialogContentText,{children:\"Dont have an account? Create one to do much more!\"}),/*#__PURE__*/_jsx(AlertUser,{severity:severity,message:message}),/*#__PURE__*/_jsx(TextField,{autoFocus:true,value:username,type:\"text\",margin:\"normal\",label:\"Username\",fullWidth:true,variant:\"outlined\",onChange:function onChange(event){return setUsername(event.target.value);}}),/*#__PURE__*/_jsx(TextField,{value:password,type:\"password\",margin:\"normal\",label:\"Password\",fullWidth:true,variant:\"outlined\",onChange:function onChange(event){return setPassword(event.target.value);}})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleCloseLogIn,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleSubmitLogIn,children:\"Log In\"})]})]});};export default LogIn;","map":{"version":3,"sources":["/Users/solomonng/dev/cvwo-rails-react-app/cvwo-react-app-2022/src/components/LogIn.tsx"],"names":["Button","TextField","Dialog","DialogActions","DialogContent","DialogTitle","DialogContentText","AlertUser","React","useState","LogIn","API","openLogIn","handleCloseLogIn","currentUserState","globalMessageState","username","setUsername","password","setPassword","severity","setSeverity","message","setMessage","resetLogIn","handleSubmitLogIn","new_message","fetch","method","headers","body","JSON","stringify","then","response","json","data","error","map","push","setCurrentUser","user","localStorage","setItem","token","setTimeout","window","location","reload","catch","console","log","event","target","value"],"mappings":"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","sourcesContent":["import { Button, TextField, Dialog, DialogActions, DialogContent, \n    DialogTitle, DialogContentText } from '@material-ui/core';\nimport AlertUser from './AlertUser';\nimport { AlertColor } from '@mui/material/Alert';\nimport CurrentUserState from '../types/CurrentUserState';\n\nimport React, { useState } from 'react';\nimport GlobalMessageState from '../types/GlobalMessageState';\n\ntype Props = {\n    openLogIn: boolean;\n    handleCloseLogIn: () => void;\n    currentUserState: CurrentUserState;\n    globalMessageState: GlobalMessageState;\n    API: string;\n}\n\nconst LogIn: React.FC<Props> = ({API, openLogIn, handleCloseLogIn, currentUserState, globalMessageState}: Props) => {\n    const [username, setUsername] = useState<string>(\"\");\n    const [password, setPassword] = useState<string>(\"\");\n\n    const [severity, setSeverity] = useState<AlertColor | undefined>('success');\n    const [message, setMessage] = useState<string[]>([]);\n\n    const resetLogIn = () => {\n        setUsername(\"\");\n        setPassword(\"\");\n    }\n\n    const handleSubmitLogIn = () => {\n        let new_message: string[] = [];\n            fetch(API + \"/login\", {\n                method: 'POST',\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                  },\n                body: JSON.stringify({\n                    username,\n                    password,\n                }),\n            })\n                .then((response) => {\n                    return response.json();\n                })\n                .then((data) => {\n                    if (data.error) {\n                        setSeverity('error');\n                        data.error.map((error: string) =>\n                            new_message.push(error));\n                        setMessage(new_message);\n                    } else {\n                        currentUserState.setCurrentUser(data.user);\n                        localStorage.setItem(\"token\", data.token);\n                        setSeverity('success');\n                        new_message.push(\"Logged in successfully!\");\n                        setMessage(new_message);\n                        resetLogIn();\n                        setTimeout(() => window.location.reload(), 1000);\n                    }\n                })\n                .catch((error) => console.log(error.message));\n    }\n\n    return (\n        <Dialog open={openLogIn} onClose={handleCloseLogIn} fullWidth>\n            <DialogTitle>Welcome Back!</DialogTitle>\n            <DialogContent>\n                <DialogContentText>\n                    Log in to create threads, comment and more...\n                </DialogContentText>\n                <DialogContentText>\n                    Dont have an account? Create one to do much more!\n                </DialogContentText>\n                <AlertUser severity={severity} message={message}/>\n                <TextField\n                    autoFocus\n                    value={username}\n                    type='text'\n                    margin=\"normal\"\n                    label=\"Username\"\n                    fullWidth\n                    variant=\"outlined\"\n                    onChange={event => setUsername(event.target.value)}\n                />\n                <TextField\n                    value={password}\n                    type='password'\n                    margin=\"normal\"\n                    label=\"Password\"\n                    fullWidth\n                    variant=\"outlined\"\n                    onChange={event => setPassword(event.target.value)}\n                />\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={handleCloseLogIn}>Cancel</Button>\n                <Button onClick={handleSubmitLogIn}>Log In</Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n\nexport default LogIn;"]},"metadata":{},"sourceType":"module"}